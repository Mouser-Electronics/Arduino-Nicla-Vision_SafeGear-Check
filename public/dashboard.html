<!DOCTYPE html>
<html>
<head>
    <title>Safety Gear Check</title>
    <title>Employee Sign In</title>
    <style>
        #welcome-message { text-align: center; font-size: 40px; }
        body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background-color: #c0d6f8; flex-direction: column; }
        .card { text-align: center; padding: 80px; border-radius: 12px; background-color: rgb(246, 249, 249); box-shadow: 0 4px 20px rgba(0,0,0,0.1);display: flex;flex-direction: column;align-items: center; }
        .status-title { font-size: 24px; color: #555; margin: 0; }
        #status-message { font-size: 40px; font-weight: bold; margin: 10px 0; min-height: 60px; }
        #start-button { font-size: 22px; padding: 15px 30px; border-radius: 8px; border: none; background-color: #0077cc;; color: white; cursor: pointer; transition: background-color 0.2s; margin-top: 10px; }
        #start-button:disabled { background-color: #555; cursor: not-allowed; }
        .default-message { font-size: 23px; text-align: center; }

        /* Frontend styles for each titles */
        body { 
            font-family: Arial, sans-serif; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            height: 100vh;
            margin: 0;
            
            background-image: url('/futuristic illustrat.png');
            background-size: cover;
            background-position: center;
            position: relative; 
            z-index: 1;
        }
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(12, 45, 72, 0.7);
            z-index: -1; 
        }

        #back-to-login-button {
            font-size: 16px;
            padding: 10px 20px;
            margin-top: 20px;
            border-radius: 8px;
            border: 1px solid #49494b;
            background-color: #c6c8c9;
            color: #10151a;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .waiting { color: #888; }
        .success { color: #28a745; }
        .failure { color: #dc3545; }
    </style>
</head>
<!-- All the buttons that are present in the login page -->
<body>
    <div class="card">
        <h2 class="status-title" id="welcome-message">Welcome!</h2>
        <h1 id="status-message" class="waiting">Ready to start check</h1>
        <button id="start-button">Start Safety Check</button>
        <button id="back-to-login-button" style="display: none;">Log Out</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <!-- Types of buttons that are present on the employee sign in page -->
    <script>
        const socket = io();
        const statusMessage = document.getElementById('status-message');
        const startButton = document.getElementById('start-button');
        const welcomeMessage = document.getElementById('welcome-message');
        const backButton = document.getElementById('back-to-login-button');

        const username = localStorage.getItem('sga-username');
        if (username) {
            welcomeMessage.textContent = `Welcome, ${username}!`;
        } else {
            window.location.href = '/';
        }

        startButton.addEventListener('click', () => {
            startButton.disabled = true;
            startButton.style.display = 'none'; 
            
            statusMessage.textContent = 'Checking...';
            statusMessage.className = 'waiting';
            backButton.style.display = 'none';

            socket.emit('start-check', { username: username });
        });

        socket.on('detection', (data) => {
            statusMessage.textContent = data;
            statusMessage.className = '';

            if (data.includes('All clear')) {
                statusMessage.classList.add('success');
            } else if (data.includes('MISSING GEAR')) {
                statusMessage.classList.add('failure');
            }
            startButton.style.display = 'none'; 
            backButton.style.display = 'block'; 
        });

        backButton.addEventListener('click', () => {
            window.location.href = '/';
        });
    </script>
</body>
</html>